##`this` എന്ന മാജിക്‌

ഒരു ഒബ്ജെക്റ്റിനു അകത്തു ഉള്ള ഫങ്ഷനില്‍ നിന്നും അതെ ഒബ്ജെക്റ്റിന്റെ ഡാറ്റ ആയിട്ടുള്ള ആസ്തികള്‍ എടുക്കാന്‍ അതുപോലെ ഒബ്ജെക്റ്റിനു അകത്തു പ്രവര്‍ത്തിക്കുന്ന ഒരു ഫങ്ഷനില്‍ നിന്നും മറ്റുള്ള അതിനകത്ത് തന്നെയുള്ള ഫങ്ഷനുകളെ വിളിക്കാന്‍ഉപയോഗിക്കാവുന്ന സൂചകപദമാണ്‌ `this`. ഇതൊരു ചരം പോലെയാണ് ഉപയോഗിക്കുന്നത്. 

ലളിതമായി പറഞ്ഞാല്‍ ഫങ്ഷന്‍റെ അത് പ്രവര്‍ത്തിക്കുമ്പോള്‍ ഉള്ള ഉടമസ്ഥന്‍ എന്നു പറയാം. 

ഇത് മനസിലാവാന്‍ കുറച്ചു പ്രയാസം ഉണ്ടാകാം.ഇനിയും മനസിലാകാത്തവര്‍ക്ക് ഒരു ഉദ്ദാഹരണം താഴെ കൊടുക്കുന്നു. എടുക്കുന്ന ഉദ്ദാഹരണം `ATM` യന്ത്രത്തിന്‍റെ പ്രവര്‍ത്തനമാണ്. യന്ത്രത്തിന്റെ പണം പിന്‍വലിക്കല്‍, ബാലന്‍സ് നോക്കല്‍ ഒക്കെ ഓരോ ഫങ്ഷനുകള്‍ ആയി എടുക്കാം. വെറുതെ പിന്‍വലിക്കുക എന്ന് പറഞ്ഞാല്‍ അതിനു ചെയ്യാന്‍ കഴിയില്ല. അതിനു നമ്മള്‍ നമ്മുടെ പിന്‍ നമ്പര്‍ കൊടുക്കണം. അപ്പോള്‍ നമ്മളാണ് അല്ലെങ്കില്‍ നമ്മുടെ അക്കൗണ്ട്‌ ആണ് അവിടത്തെ സന്ദര്‍ഭത്തിന് അനുസരിച്ചുള്ള ഡാറ്റ. അങ്ങനെ ഒരു അക്കൗണ്ട്‌ അതിനു കിട്ടിയാല്‍, പിന്നെ അതിന്‍റെ ഫങ്ഷനുകള്‍ അതിനു ചെയ്യാന്‍ കഴിയും. വേറെ ആള്‍ വരുമ്പോള്‍ അതിന്‍റെ ഉടമസ്ഥന്‍ മാറുന്നു. പക്ഷെ ചെയ്യുന്ന പണി ഒന്നുതന്നെ.

ഇതുപോലെയാണ് ജാവസ്ക്രിപ്റ്റ് ഭാഷയിലെ ഫങ്ഷന്‍ അതിന്‍റെ സന്ദര്‍ഭത്തിന് ചേര്‍ന്ന ഡാറ്റയില്‍ മാറ്റങ്ങള്‍ വരുത്തുന്നത്. ഫങ്ഷനില്‍ `this` ഉപയോഗിക്കുന്നില്ലെങ്കില്‍ സന്ദര്‍ഭം അതിനു ഒരു പ്രശ്നവും ഇല്ല. 

ഫങ്ഷന്‍ പ്രവര്‍ത്തിക്കുന്ന സന്ദര്‍ഭത്തിന് അനുസരിച്ച് `this` എന്ന ചരത്തിന്റെ ഡാറ്റ മാറാം. ഒരു ഉദാഹരണം താഴെ.

![turnLeft without this](images/ch08/05/01-turnLeftInVar.PNG)
ഇവിടെ `karel` ഒബ്ജെക്റ്റ് ഉപയോഗിച്ച് `turnLeft` ഫങ്ഷന്‍ വിളിക്കുമ്പോള്‍ അത് പ്രവര്‍ത്തിക്കുന്നത് കാണാം.പക്ഷെ അതെ ഫങ്ഷന്‍ ഒരു ചരത്തില്‍ എടുത്തു വച്ചിട്ട് പ്രവര്‍ത്തിപ്പിച്ചാല്‍ അത് വിചാരിച്ച ഫലം അതായത് കരെലിനെ ഇടത്തോട്ടു തിരിക്കുന്നില്ല. രണ്ടാമത് ഫങ്ഷന്‍ പ്രവര്‍ത്തിപ്പിച്ചപ്പോള്‍ ഫലം ഉണ്ടാക്കാതിരുന്നത് അതിനു വേണ്ട ഉടമസ്ഥന്‍ ഇല്ലാതിരുന്നത് കൊണ്ടാണ്. ഇടത്തോട്ടു തിരിയാന്‍ പറഞ്ഞു എന്തിനെയാണ് തിരിക്കേണ്ടത്‌ എന്ന് പറഞ്ഞില്ല.


### സന്ദര്‍ഭം എങ്ങിനെ അനുയോജ്യമാക്കം 

ഒരു ഫങ്ഷന്‍ നമുക്ക് ഒരു ചരത്തില്‍ കിട്ടി എന്നിരിക്കട്ടെ. അതിനെ നമുക്ക് പ്രവര്‍ത്തിപ്പിക്കണം. അത് പ്രവര്‍ത്തിക്കാന്‍ ഒരു `this` ഒബ്ജെക്റ്റ് ആവശ്യമാണ്. അതിനു വേണ്ടിയുള്ള `this` എന്ന ഒബ്ജെക്റ്റ് എങ്ങിനെ കൊടുക്കാം?

അതിനുള്ള 2 വഴികളാണ് call() & apply() ഫങ്ഷനുകള്‍. രണ്ടിനും ചെറിയ വ്യത്യാസങ്ങള്‍ മാത്രമേയുള്ളൂ. മുന്‍പ് പറഞ്ഞപോലെ ഒരേ കാര്യം ചെയ്യാന്‍ ഭാഷയില്‍ ഒന്നില്‍ കൂടുതല്‍ സങ്കേതങ്ങള്‍ ഉണ്ട്.

`Program call apply`

ഇപ്പോള്‍ പ്രോഗ്രാം വിചാരിച്ച ഫലം തരുന്നുണ്ടെന്നു കണ്ടല്ലോ. കരെല്‍ 3 തവണ ഇടത്തോട്ട് തിരിഞ്ഞു. മുന്‍പ് കണ്ട ഉദ്ദാഹരണം എങ്ങിനെ `call` അതുപോലെ `apply` ഉപയോഗിച്ചപ്പോള്‍ ശരിയായെന്നു പരിശോദിക്കാം.

ഈ രണ്ടു ഫങ്ഷനുകളും പ്രവര്‍ത്തിപ്പിച്ചിരിക്കുന്നത് `operation` എന്ന ചരം ഉപയോഗിച്ചാണ്‌. അതിലാകട്ടെ ഇരിക്കുന്നത് ഒരു ഫങ്ഷന്‍ ആണ്. ഈ ഫങ്ഷനുകള്‍ അവ പ്രവര്‍ത്തിപ്പിക്കാന്‍ ഉപയോഗിച്ച ഫങ്ഷനെ പ്രവര്‍ത്തിപ്പിക്കുകയാണ് ചെയ്യുക. എന്നിട്ട് ആദ്യത്തെ പരമെറ്റര്‍ `this` ആക്കി സെറ്റ് ചെയ്യും. അപ്പോള്‍ നമ്മുടെ `turnLeft` എന്ന ഫങ്ഷന് `karel` ഒബ്ജക്റ്റ് കിട്ടുകയും അത് നമുക്ക് വേണ്ട രീതിയില്‍ പ്രവര്‍ത്തിക്കുകയും ചെയ്യും.

അപ്പോഴും ഒരു ചോദ്യം ബാക്കി നില്‍ക്കുന്നു. call, apply തമ്മില്‍ എന്തെങ്കിലും വ്യത്യാസം ഉണ്ടോ?

### `call v/s apply`
പ്രവര്‍ത്തിപ്പിക്കാന്‍ പോകുന്ന ഫങ്ഷന് പരമെറ്ററുകള്‍ ഒന്നും തന്നെ ഇല്ലെങ്കില്‍ ഇവ തമ്മില്‍ വ്യത്യാസമില്ല. പക്ഷെ ഏതെങ്കിലും പരമെറ്റര്‍ ഉണ്ടെങ്കില്‍ ആ പരമെറ്ററുകള്‍ കൊടുക്കുന്നതില്‍ വ്യത്യാസമുണ്ട്. ഉദ്ദാഹരണം താഴെ.


###ആഗോള(`global`) `this`

സാധാരണ നമ്മള്‍ ഫങ്ഷന്‍ എഴുതുന്നത് ഒരു ഒബ്ജെക്റ്റിനു അകത്ത് അല്ല. അപ്പോള്‍ `this` എന്ന ചരത്തില്‍ ഡാറ്റ ഉണ്ടാകുമോ? അങ്ങനെയുണ്ടെങ്കില്‍ അതിനെ നമുക്ക് ആഗോള `this` എന്ന് വിളിക്കാം. താഴെ കൊടുത്തിരിക്കുന്ന പ്രോഗ്രാം പ്രവര്‍ത്തിപ്പിക്കുക.

`കോഡ് to ഗ്ലോബല്‍ this`

`undefined` എന്ന് മെസ്സേജ് ബോക്സില്‍ വരുന്നത് കാണാം. അങ്ങനെ വരുന്നത് നമ്മുടെ പ്രോഗ്രാം `strict mode` ഇല്‍ പ്രവര്‍ത്തിക്കുന്നത് കൊണ്ടാണ്. സാധാരണ വെബ്‌ പേജുകളില്‍ ജാവാസ്ക്രിപ്റ്റ് എഴുതുമ്പോള്‍ `this` എന്ന ചരത്തില്‍ `window` എന്ന ഒബ്ജക്റ്റ് ഉണ്ടായിരിക്കും. അവിടെ അതാണ് ആഗോള `this`. 
